<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Title -->
  <title>Umariyya Alumni Meet 2025 - Photo Frame</title>
  
  <!-- Favicon (Browser Tab Icon) -->
  <link rel="icon" type="image/png" href="icon.png">
  <link rel="apple-touch-icon" href="icon.png">
  
  <!-- Thumbnail for URL Sharing (WhatsApp, Facebook, Twitter, etc.) -->
  <meta property="og:title" content="Umariyya Alumni Meet 2025 - Photo Frame">
  <meta property="og:description" content="Create your personalized photo frame for Umariyya Alumni Meet on November 2nd, 2025">
  <meta property="og:image" content="https://MIKTHADPK.git.io/profile-frames/thumbnail.jpg">
  <meta property="og:url" content="https://MIKTHADPK.git.io/profile-frames/">
  <meta property="og:type" content="website">
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Umariyya Alumni Meet 2025">
  <meta name="twitter:description" content="Create your personalized photo frame">
  <meta name="twitter:image" content="https://MIKTHADPK.git.io/profile-frames/thumbnail.jpg">
  
  <!-- Theme Color -->
  <meta name="theme-color" content="#0d7fa8">
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  
  <style>
    /* Your CSS from previous code here */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: #f0f0f0;
      overflow-x: hidden;
      line-height: 1.6;
    }

    .container {
      max-width: 100%;
      margin: 0 auto;
      background: white;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* Header */
    .header {
      background: linear-gradient(135deg, #0d7fa8 0%, #1a5f7a 100%);
      padding: 5px 20px;
      color: white;
      text-align: left;
      position: relative;
    }

    .header h1 {
      font-size: 3.2em;
      font-weight: 800;
      color: #ffd700;
      margin-bottom: -30px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      letter-spacing: 2px;
    }

    .header h2 {
      font-size: 2.2em;
      font-weight: 600;
      color: #ffffff;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      letter-spacing: 6px;
    }

    .date-badge {
      position: absolute;
      top: 30px;
      right: 30px;
      background: white;
      color: #0d7fa8;
      padding: 15px 25px;
      border-radius: 15px;
      box-shadow: 0 6px 15px rgba(0,0,0,0.2);
      text-align: center;
      font-family: 'Poppins', sans-serif;
    }

    .date-badge .day {
      font-size: 2.5em;
      font-weight: 700;
      line-height: 0;
    }

    .date-badge .suffix {
      font-size: 1.2em;
      font-weight: 600;
      vertical-align: super;
    }

    .date-badge .month-year {
      font-size: 1.1em;
      font-weight: 600;
      margin-top: 3px;
      line-height: 1;
    }

    /* Canvas Area */
    .canvas-area {
      flex: 1;
      background: #e8e8e8;
      padding: 40px 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 50vh;
    }

    #twibbonCanvas {
      border: 4px solid #0d7fa8;
      background: #ffffff;
      cursor: grab;
      max-width: 100%;
      height: auto;
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
      border-radius: 8px;
      touch-action: none;
    }

    /* Controls */
    .controls {
      background: white;
      padding: 30px 20px;
    }

    /* Upload and Download Button Row */
    .main-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 25px;
    }

    .upload-btn, .download-btn {
      background: linear-gradient(135deg, #0d7fa8 0%, #1a5f7a 100%);
      color: white;
      padding: 18px 20px;
      border: none;
      border-radius: 12px;
      font-size: 2em;
      font-weight: 600;
      font-family: 'Poppins', sans-serif;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 6px 15px rgba(13, 127, 168, 0.3);
      transition: all 0.3s ease;
    }

    .upload-btn:hover, .download-btn:hover:not(:disabled) {
      background: linear-gradient(135deg, #0a6a8f 0%, #154a60 100%);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(13, 127, 168, 0.4);
    }

    .upload-btn:active, .download-btn:active:not(:disabled) {
      transform: translateY(0);
    }

    .download-btn:disabled {
      background: linear-gradient(135deg, #ccc 0%, #999 100%);
      cursor: not-allowed;
      transform: none;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      opacity: 0.6;
    }

    input[type="file"] {
      display: none;
    }

    /* Material Icons Styling */
    .material-symbols-outlined {
      font-variation-settings:
      'FILL' 1,
      'wght' 400,
      'GRAD' 0,
      'opsz' 48;
      color: white;
      font-size: 1em;
    }

    /* Action Buttons */
    .action-buttons {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 0;
      flex-wrap: wrap;
    }

    .action-btn {
      width: 70px;
      height: 70px;
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      border: 3px solid #0d7fa8;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8em;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      position: relative;
    }

    .action-btn .material-symbols-outlined {
      color: #0d7fa8;
      font-size: 1.5em;
      font-variation-settings:
      'FILL' 0,
      'wght' 500,
      'GRAD' 0,
      'opsz' 48;
    }

    .action-btn:hover {
      background: linear-gradient(135deg, #0d7fa8 0%, #1a5f7a 100%);
      transform: scale(1.1) translateY(-2px);
      box-shadow: 0 6px 20px rgba(13, 127, 168, 0.3);
    }

    .action-btn:hover .material-symbols-outlined {
      color: white;
    }

    .action-btn:active {
      transform: scale(0.95);
    }

    .action-btn.disabled {
      opacity: 0.4;
      cursor: not-allowed;
      pointer-events: none;
    }

    /* Footer */
    .footer {
      background: linear-gradient(135deg, #0d7fa8 0%, #1a5f7a 100%);
      color: white;
      padding: 25px 20px;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
    }

    .footer-avatar {
      width: 70px;
      height: 70px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      overflow: hidden;
      border: 3px solid rgba(255,255,255,0.2);
    }

    .footer-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .footer-text {
      font-size: 1.1em;
      font-weight: 500;
      text-align: left;
      font-family: 'Poppins', sans-serif;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .header {
        padding: 30px 15px;
      }

      .header h1 {
        font-size: 2.2em;
        letter-spacing: 1px;
      }

      .header h2 {
        font-size: 1.5em;
        margin-top: 7px;
        letter-spacing: 4.5px;
      }

      .date-badge {
        top: 20px;
        right: 15px;
        padding: 12px 18px;
      }

      .date-badge .day {
        font-size: 2em;
      }

      .canvas-area {
        padding: 25px 15px;
      }

      .controls {
        padding: 25px 15px;
      }

      .main-buttons {
        gap: 12px;
      }

      .upload-btn, .download-btn {
        padding: 15px;
        font-size: 1.8em;
      }

      .action-btn {
        width: 60px;
        height: 60px;
      }

      .footer {
        padding: 20px 15px;
        gap: 15px;
      }
    }

    @media (max-width: 480px) {
      .header h1 {
        font-size: 1.8em;
      }

      .header h2 {
        font-size: 1.2em;
        margin-top: 12px;
        letter-spacing: 4px;
      }

      .upload-btn, .download-btn {
        padding: 12px;
        font-size: 1.6em;
      }

      .action-btn {
        width: 55px;
        height: 55px;
      }

      .footer {
        flex-direction: column;
      }

      .footer-text {
        font-size: 0.9em;
        text-align: center;
      }
    }

    button, .upload-btn {
      transition: all 0.3s ease;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <h1>UMARIYYA</h1>
      <h2>ALUMNI MEET</h2>
      <div class="date-badge">
        <div>
          <span class="day">02</span><span class="suffix">nd</span>
        </div>
        <div class="month-year">Nov.<br>2025</div>
      </div>
    </div>

    <!-- Canvas Area -->
    <div class="canvas-area">
      <canvas id="twibbonCanvas" width="400" height="400"></canvas>
    </div>

    <!-- Controls -->
    <div class="controls">
      <!-- Upload and Download Button Row -->
      <div class="main-buttons">
        <label for="userPhoto" class="upload-btn">
          <span class="material-symbols-outlined">photo_camera</span>
        </label>
        <button class="download-btn" id="downloadBtn" disabled>
          <span class="material-symbols-outlined">download</span>
        </button>
      </div>
      <input type="file" id="userPhoto" accept="image/*">

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button class="action-btn disabled" id="rotateLeftBtn" title="Rotate Left">
          <span class="material-symbols-outlined">rotate_left</span>
        </button>
        <button class="action-btn disabled" id="rotateRightBtn" title="Rotate Right">
          <span class="material-symbols-outlined">rotate_right</span>
        </button>
        <button class="action-btn disabled" id="zoomOutBtn" title="Zoom Out">
          <span class="material-symbols-outlined">zoom_out</span>
        </button>
        <button class="action-btn disabled" id="zoomInBtn" title="Zoom In">
          <span class="material-symbols-outlined">zoom_in</span>
        </button>
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">
      <div class="footer-avatar">
        <img src="avatar.jpg" alt="Developer Avatar" onerror="this.style.display='none'; this.parentNode.innerHTML='<span class=\'material-symbols-outlined\' style=\'font-size:2em;color:#0d7fa8;\'>person</span>';">
      </div>
      <div class="footer-text">
        Developed by: Miqdad Sa-adi Al-Afzali
      </div>
    </div>
  </div>

  <script>
    const canvas = document.getElementById('twibbonCanvas');
    const ctx = canvas.getContext('2d');
    const downloadBtn = document.getElementById('downloadBtn');
    const rotateLeftBtn = document.getElementById('rotateLeftBtn');
    const rotateRightBtn = document.getElementById('rotateRightBtn');
    const zoomInBtn = document.getElementById('zoomInBtn');
    const zoomOutBtn = document.getElementById('zoomOutBtn');
    
    // Display and export sizes
    const DISPLAY_SIZE = 400;
    const EXPORT_SIZE = 1080;
    const SCALE_RATIO = EXPORT_SIZE / DISPLAY_SIZE;
    
    let userImg = new Image(), frameImg = new Image();
    let dragging = false, offsetX = 0, offsetY = 0, pos = {x: 50, y: 50};
    let userImgLoaded = false, frameImgLoaded = false, scale = 1;
    let originalWidth = 0, originalHeight = 0;
    let aspectRatio = 1;
    let lastDist = null;
    let rotation = 0;

    // Responsive canvas sizing
    function resizeCanvas() {
      const container = canvas.parentElement;
      const containerWidth = container.clientWidth - 40;
      const maxSize = Math.min(containerWidth, 400);
      
      if (maxSize < 400) {
        canvas.style.width = maxSize + 'px';
        canvas.style.height = maxSize + 'px';
      } else {
        canvas.style.width = '400px';
        canvas.style.height = '400px';
      }
    }

    // Initialize responsive canvas
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    function getScaledDimensions() {
      return {
        width: originalWidth * scale,
        height: originalHeight * scale
      };
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      if (userImgLoaded) {
        const dims = getScaledDimensions();
        ctx.save();
        ctx.translate(pos.x + dims.width/2, pos.y + dims.height/2);
        ctx.rotate(rotation * Math.PI / 180);
        ctx.drawImage(userImg, -dims.width/2, -dims.height/2, dims.width, dims.height);
        ctx.restore();
      }
      
      if (frameImgLoaded) {
        ctx.drawImage(frameImg, 0, 0, canvas.width, canvas.height);
      }
    }

    // Load frame
    frameImg.onload = function() {
      console.log("Frame loaded successfully");
      frameImgLoaded = true;
      draw();
    };
    frameImg.onerror = function() {
      console.log("Frame failed to load - continuing without frame");
    };
    frameImg.src = './frame.png';

    // User photo upload
    document.getElementById('userPhoto').onchange = function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(event) {
          userImg = new Image();
          userImg.onload = function() {
            originalWidth = userImg.naturalWidth;
            originalHeight = userImg.naturalHeight;
            aspectRatio = originalWidth / originalHeight;
            
            const maxSize = 250;
            if (originalWidth > originalHeight) {
              originalWidth = Math.min(originalWidth, maxSize);
              originalHeight = originalWidth / aspectRatio;
            } else {
              originalHeight = Math.min(originalHeight, maxSize);
              originalWidth = originalHeight * aspectRatio;
            }
            
            userImgLoaded = true;
            pos = {x: 75, y: 75};
            scale = 1;
            rotation = 0;
            draw();
            
            // Enable buttons
            downloadBtn.disabled = false;
            rotateLeftBtn.classList.remove('disabled');
            rotateRightBtn.classList.remove('disabled');
            zoomInBtn.classList.remove('disabled');
            zoomOutBtn.classList.remove('disabled');
          };
          userImg.src = event.target.result;
        };
        reader.readAsDataURL(file);
      }
    };

    // Button functionalities
    rotateLeftBtn.onclick = function() {
      if (!userImgLoaded) return;
      rotation -= 90;
      draw();
    };

    rotateRightBtn.onclick = function() {
      if (!userImgLoaded) return;
      rotation += 90;
      draw();
    };

    zoomInBtn.onclick = function() {
      if (!userImgLoaded) return;
      scale = Math.min(5, scale * 1.2);
      draw();
    };

    zoomOutBtn.onclick = function() {
      if (!userImgLoaded) return;
      scale = Math.max(0.2, scale * 0.8);
      draw();
    };

    // Drag functionality - Mouse
    canvas.onmousedown = function(e) {
      if (!userImgLoaded) return;
      const rect = canvas.getBoundingClientRect();
      const scaleX = canvas.width / rect.width;
      const scaleY = canvas.height / rect.height;
      const x = (e.clientX - rect.left) * scaleX;
      const y = (e.clientY - rect.top) * scaleY;
      const dims = getScaledDimensions();
      
      if (x >= pos.x && x <= pos.x + dims.width && 
          y >= pos.y && y <= pos.y + dims.height) {
        dragging = true;
        offsetX = x - pos.x;
        offsetY = y - pos.y;
        canvas.style.cursor = "grabbing";
      }
    };

    canvas.onmousemove = function(e) {
      if (dragging && userImgLoaded) {
        const rect = canvas.getBoundingClientRect();
        const scaleX = canvas.width / rect.width;
        const scaleY = canvas.height / rect.height;
        pos.x = (e.clientX - rect.left) * scaleX - offsetX;
        pos.y = (e.clientY - rect.top) * scaleY - offsetY;
        draw();
      }
    };

    canvas.onmouseup = canvas.onmouseleave = function() {
      dragging = false;
      canvas.style.cursor = "grab";
    };

    // Touch events
    canvas.addEventListener('touchstart', function(e) {
      if (!userImgLoaded) return;
      
      if (e.touches.length === 1) {
        const rect = canvas.getBoundingClientRect();
        const scaleX = canvas.width / rect.width;
        const scaleY = canvas.height / rect.height;
        const x = (e.touches[0].clientX - rect.left) * scaleX;
        const y = (e.touches[0].clientY - rect.top) * scaleY;
        const dims = getScaledDimensions();
        
        if (x >= pos.x && x <= pos.x + dims.width && 
            y >= pos.y && y <= pos.y + dims.height) {
          dragging = true;
          offsetX = x - pos.x;
          offsetY = y - pos.y;
          e.preventDefault();
        }
      } else if (e.touches.length === 2) {
        e.preventDefault();
        lastDist = Math.hypot(
          e.touches[0].pageX - e.touches[1].pageX,
          e.touches[0].pageY - e.touches[1].pageY
        );
      }
    }, {passive: false});

    canvas.addEventListener('touchmove', function(e) {
      if (!userImgLoaded) return;
      
      if (e.touches.length === 1 && dragging) {
        e.preventDefault();
        const rect = canvas.getBoundingClientRect();
        const scaleX = canvas.width / rect.width;
        const scaleY = canvas.height / rect.height;
        pos.x = (e.touches[0].clientX - rect.left) * scaleX - offsetX;
        pos.y = (e.touches[0].clientY - rect.top) * scaleY - offsetY;
        draw();
      } else if (e.touches.length === 2 && lastDist !== null) {
        e.preventDefault();
        let newDist = Math.hypot(
          e.touches[0].pageX - e.touches[1].pageX,
          e.touches[0].pageY - e.touches[1].pageY
        );
        let diff = newDist / lastDist;
        scale = Math.max(0.2, Math.min(5, scale * diff));
        lastDist = newDist;
        draw();
      }
    }, {passive: false});

    canvas.addEventListener('touchend', function(e) {
      dragging = false;
      if (e.touches.length < 2) {
        lastDist = null;
      }
    }, {passive: false});

    // Mouse wheel zoom
    canvas.addEventListener('wheel', function(e) {
      if (userImgLoaded) {
        e.preventDefault();
        const delta = e.deltaY < 0 ? 1.1 : 0.9;
        scale = Math.max(0.2, Math.min(5, scale * delta));
        draw();
      }
    }, {passive: false});

    // High-resolution download
    downloadBtn.onclick = function() {
      if (!userImgLoaded) return;

      const exportCanvas = document.createElement('canvas');
      exportCanvas.width = EXPORT_SIZE;
      exportCanvas.height = EXPORT_SIZE;
      const exportCtx = exportCanvas.getContext('2d');

      const dims = getScaledDimensions();
      const scaledPosX = pos.x * SCALE_RATIO;
      const scaledPosY = pos.y * SCALE_RATIO;
      const scaledWidth = dims.width * SCALE_RATIO;
      const scaledHeight = dims.height * SCALE_RATIO;

      exportCtx.save();
      exportCtx.translate(scaledPosX + scaledWidth/2, scaledPosY + scaledHeight/2);
      exportCtx.rotate(rotation * Math.PI / 180);
      exportCtx.drawImage(userImg, -scaledWidth/2, -scaledHeight/2, scaledWidth, scaledHeight);
      exportCtx.restore();

      if (frameImgLoaded) {
        exportCtx.drawImage(frameImg, 0, 0, EXPORT_SIZE, EXPORT_SIZE);
      }

      const link = document.createElement('a');
      link.download = 'umariyya-alumni-meet-1080x1080.png';
      link.href = exportCanvas.toDataURL('image/png');
      link.click();
    };
  </script>
</body>
</html>
